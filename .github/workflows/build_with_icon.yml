name: Build macOS App with Icon

on:
  push:
    branches: [ "main" ]
  workflow_dispatch: # 驻砖专 专抓 转 爪转 驻转专

jobs:
  build:
    runs-on: macos-latest

    steps:
    # 1. 砖转 拽 拽爪 砖 ( 拽)
    - uses: actions/checkout@v3

    # 2. 转拽转 驻转
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    # 3. 转拽转 住驻专转 专砖转
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pyinstaller tk

    # 4. 拽驻 注爪 -  住驻 转 拽
    - name: Build with PyInstaller
      run: |
        # 驻拽 转 注砖 转  拽
        pyinstaller --onefile --windowed --icon="3.icns" --name "SystemGuard" Install_Videonet_Block.py
# ... (砖 4 住转, 拽抓 SystemGuard.app 爪专) ...

    - name: Zip the App for Upload
      run: |
        cd dist
        zip -r SystemGuard.zip SystemGuard.app
        
    - name: Upload to Google Drive 
      uses: adityak74/google-drive-upload-git-action@v1.0.9
      with:
        # 拽爪 砖住转专 砖 拽
        credentials: ${{ secrets.GDRIVE_CREDENTIALS_B64 }}
        
        # 转 拽抓 砖专爪 注转
        upload-to: SystemGuard/
        
        # 拽抓 砖 注 注转
        file-path: dist/SystemGuard.zip
        
        # 驻砖专 专住 拽抓 砖 (砖!)
        overwrite: true
        
        # 爪专 转拽 砖 Build_${{ github.run_number }} 转 专
        create-folder: true
        
        # 注 转 -ZIP 转拽转 注.
        # 转拽 转 转 转拽 砖砖转驻转 注 砖 砖专转 (砖 1).
